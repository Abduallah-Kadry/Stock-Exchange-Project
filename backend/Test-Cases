I've created a comprehensive test suite for your StockService with 24 test cases covering various scenarios:
Test Coverage Overview
1. getAllStocks (3 tests)

âœ… Success case with pagination
âœ… Empty page when no stocks exist
âœ… Descending sort order

2. getAllStockExchangesByStock (3 tests)

âœ… Success case with valid stock
âœ… Exception when stock not found
âœ… Empty page when stock has no listings

3. createStock (3 tests)

âœ… Success case
âœ… Exception when duplicate name exists
âœ… Creating with different price values

4. updatePrice (4 tests)

âœ… Success case
âœ… Exception when stock not found
âœ… Updating to zero price
âœ… Updating with large price value

5. deleteStock (5 tests)

âœ… Success case
âœ… Exception when stock not found
âœ… Deleting with multiple affected exchanges
âœ… Deleting with no listings
âœ… Handling duplicate exchanges (distinct behavior)

ðŸ“‹ Test Methods Included (31 tests)
1. deleteStockExchange - 4 tests

Success, Not Found, Cascade Delete, Null Listings

2. getAllStocksByExchange - 5 tests

Success, Exchange Not Found, No Stocks, With Sorting, Pagination

3. addStockToStockExchange - 6 tests

Success, Already Listed, Exchange Not Found, Stock Not Found, Update Live Status to True, No Live Status Change

4. removeStockFromStockExchange - 6 tests

Success, Exchange Not Found, Stock Not Listed, Update Live Status to False, No Live Status Change, Last Stock

5. updateLiveMarketStatus - 8 tests

Set to True, Set to False, No Change When Already Live, No Change When Already Not Live, Exactly 10 Stocks, Zero Stocks, Large Number of Stocks, Transition from Live to Not Live